function mailchimpGetCurrentUserByHash(a){try{var b=mailchimp_public_data.site_url+"?mailchimp-woocommerce[action]=parse-email&mailchimp-woocommerce[submission][hash]="+a,c=new XMLHttpRequest;c.open("POST",b,!0),c.onload=function(){if(c.status>=200&&c.status<400){var a=JSON.parse(c.responseText);mailchimp_cart.valueEmail(a.email)&&(mailchimp_cart.setEmail(a.email),console.log("mailchimp","setting "+a.email+" as the current user"))}else console.log("error",c.responseText)},c.onerror=function(){console.log("get email error",c.responseText)},c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Accept","application/json"),c.send()}catch(a){console.log("mailchimp.get_email_by_hasn.error",a)}}function mailchimpHandleBillingEmail(){var a=document.querySelector("#billing_email"),b=void 0!==a?a.value:"";if(!mailchimp_cart.valueEmail(b))return!1;mailchimp_cart.setEmail(b);try{var c=mailchimp_public_data.site_url+"?mailchimp-woocommerce[action]=submit-email&mailchimp-woocommerce[submission][email]="+b,d=new XMLHttpRequest;d.open("POST",c,!0),d.onload=function(){d.status>=200&&d.status<400?console.log("success",d.responseText):console.log("error",d.responseText)},d.onerror=function(){console.log("submit email error",d.responseText)},d.setRequestHeader("Content-Type","application/json"),d.setRequestHeader("Accept","application/json"),d.send()}catch(a){console.log("mailchimp_campaign_tracking.error",a)}}var mailchimp,mailchimp_cart,mailchimp_public_data,mailchimp_billing_email,mailchimpReady=function(a){/in/.test(document.readyState)?setTimeout("mailchimpReady("+a+")",9):a()};!function(){"use strict";function n(){return this.email_types="input[type=email]",this.regex_email=/^([A-Za-z0-9_+\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,this.current_email=null,this.previous_email=null,this.expireUser=function(){this.current_email=null,mailchimp.storage.expire("mailchimp.cart.current_email")},this.expireSaved=function(){mailchimp.storage.expire("mailchimp.cart.items")},this.setEmail=function(a){this.valueEmail(a)&&(this.setPreviousEmail(this.getEmail()),this.current_email=a,mailchimp.storage.set("mailchimp.cart.current_email",a))},this.getEmail=function(){if(this.current_email)return this.current_email;var a=mailchimp.storage.get("mailchimp.cart.current_email",!1);return!(!a||!this.valueEmail(a))&&(this.current_email=a,a)},this.setPreviousEmail=function(a){this.valueEmail(a)&&(mailchimp.storage.set("mailchimp.cart.previous_email",a),this.previous_email=a)},this.valueEmail=function(a){return this.regex_email.test(a)},this}mailchimp_public_data=public_data||{site_url:document.location.origin};var k={extend:function(a,b){for(var c in b||{})b.hasOwnProperty(c)&&(a[c]=b[c]);return a},getQueryStringVars:function(){var a=window.location.search||"",b=[],c={};if(a=a.substr(1),a.length){b=a.split("&");for(var d in b){var e=b[d];if("string"==typeof e){var f=e.split("="),g=f[0],h=f[1];g.length&&("undefined"==typeof c[g]&&(c[g]=[]),c[g].push(h))}}}return c},unEscape:function(a){return decodeURIComponent(a)},escape:function(a){return encodeURIComponent(a)},createDate:function(a,b){a||(a=0);var c=new Date,d=b?c.getDate()-a:c.getDate()+a;return c.setDate(d),c},arrayUnique:function(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c]===b[d]&&b.splice(d,1);return b},objectCombineUnique:function(a){for(var b=a[0],c=1;c<a.length;c++){var d=a[c];for(var e in d)b[e]=d[e]}return b}},l=function(a,b){var c=function(a,b,d){return 1===arguments.length?c.get(a):c.set(a,b,d)};return c.get=function(b,d){return a.cookie!==c._cacheString&&c._populateCache(),void 0==c._cache[b]?d:c._cache[b]},c.defaults={path:"/"},c.set=function(d,e,f){switch(f={path:f&&f.path||c.defaults.path,domain:f&&f.domain||c.defaults.domain,expires:f&&f.expires||c.defaults.expires,secure:f&&f.secure!==b?f.secure:c.defaults.secure},e===b&&(f.expires=-1),typeof f.expires){case"number":f.expires=new Date((new Date).getTime()+1e3*f.expires);break;case"string":f.expires=new Date(f.expires)}return d=encodeURIComponent(d)+"="+(e+"").replace(/[^!#-+\--:<-\[\]-~]/g,encodeURIComponent),d+=f.path?";path="+f.path:"",d+=f.domain?";domain="+f.domain:"",d+=f.expires?";expires="+f.expires.toGMTString():"",d+=f.secure?";secure":"",a.cookie=d,c},c.expire=function(a,d){return c.set(a,b,d)},c._populateCache=function(){c._cache={};try{c._cacheString=a.cookie;for(var d=c._cacheString.split("; "),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=decodeURIComponent(d[e].substr(0,f)),f=decodeURIComponent(d[e].substr(f+1));c._cache[g]===b&&(c._cache[g]=f)}}catch(a){console.log(a)}},c.enabled=function(){var a="1"===c.set("cookies.js","1").get("cookies.js");return c.expire("cookies.js"),a}(),c}(document);mailchimp={storage:l,utils:k},mailchimp_cart=new n}(),mailchimpReady(function(){var a=mailchimp.utils.getQueryStringVars();if(void 0!==a.mc_cart_id&&mailchimpGetCurrentUserByHash(a.mc_cart_id),void 0!==a.mc_cid&&void 0!==a.mc_eid){var b=mailchimp_public_data.site_url+"?mailchimp-woocommerce[action]=track-campaign&mailchimp-woocommerce[submission][campaign_id]="+a.mc_cid[0]+"&mailchimp-woocommerce[submission][email_id]="+a.mc_eid[0];try{var c=new XMLHttpRequest;c.open("POST",b,!0),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Accept","application/json"),c.send(data)}catch(a){console.log("mailchimp_campaign_tracking.error",a)}}mailchimp_billing_email=document.querySelector("#billing_email"),mailchimp_billing_email&&(mailchimp_billing_email.onblur=function(){mailchimpHandleBillingEmail()},mailchimp_billing_email.onfocus=function(){mailchimpHandleBillingEmail()})});
